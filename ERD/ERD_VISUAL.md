# ğŸ“Š Rangira Agro Farming - ERD Visual Representation

## ğŸ¯ Database Overview

**Total Entities:** 9  
**Total Relationships:** 15 (including self-referencing)  
**Database Type:** PostgreSQL  
**Schema:** Auto-generated by Hibernate

---

## ğŸ—ºï¸ Entity Relationship Diagram (ASCII)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         RANGIRA AGRO FARMING SYSTEM                                  â”‚
â”‚                         Entity Relationship Diagram                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   LOCATION   â”‚â—„â”€â”€â”€â”€â” Self-referencing
                    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚     â”‚ (parent/child)
                    â”‚ PK: id       â”‚     â”‚
                    â”‚ UK: code     â”‚â”€â”€â”€â”€â”€â”˜
                    â”‚     name     â”‚
                    â”‚     level    â”‚
                    â”‚ FK: parent_idâ”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚ 1:M              1:M
                 â–¼                   â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚      USER      â”‚  â”‚  STORAGE_WAREHOUSE  â”‚
        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
        â”‚ PK: id         â”‚  â”‚ PK: id              â”‚
        â”‚ UK: user_code  â”‚  â”‚ UK: warehouse_code  â”‚
        â”‚ UK: email      â”‚  â”‚     warehouse_name  â”‚
        â”‚ UK: phone      â”‚  â”‚     warehouse_type  â”‚
        â”‚     first_name â”‚  â”‚     total_capacity  â”‚
        â”‚     last_name  â”‚  â”‚     available_cap.  â”‚
        â”‚     password   â”‚  â”‚     status          â”‚
        â”‚     user_type  â”‚  â”‚ FK: location_id     â”‚
        â”‚     status     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚ FK: location_idâ”‚             â”‚
        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
             â”‚ 1:1                     â”‚ M:M (via junction)
             â”‚                         â”‚
             â–¼                         â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
    â”‚  USER_PROFILE   â”‚               â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚               â”‚
    â”‚ PK: id          â”‚               â”‚
    â”‚ UK,FK: user_id  â”‚               â”‚
    â”‚     national_id â”‚               â”‚
    â”‚     dob         â”‚               â”‚
    â”‚     gender      â”‚               â”‚
    â”‚     bio         â”‚               â”‚
    â”‚     verified    â”‚               â”‚
    â”‚     avg_rating  â”‚               â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
                                      â”‚
        USER â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
             â”‚                        â”‚
             â”‚ M:M                    â”‚
             â”‚                        â”‚
             â–¼                        â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ WAREHOUSE_ACCESS â”‚     â”‚   CROP_TYPE      â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
    â”‚ PK: id           â”‚     â”‚ PK: id           â”‚
    â”‚ FK: user_id      â”‚     â”‚ UK: crop_code    â”‚
    â”‚ FK: warehouse_id â”‚     â”‚     crop_name    â”‚
    â”‚     access_level â”‚     â”‚     category     â”‚
    â”‚     granted_date â”‚     â”‚     measure_unit â”‚
    â”‚     expiry_date  â”‚     â”‚     description  â”‚
    â”‚     is_active    â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚ UNIQUE(user,wh)  â”‚               â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚ 1:M
                                       â”‚
        USER â”€â”€â”                       â”‚
               â”‚ 1:M (farmer)          â”‚
               â”‚ 1:M (storekeeper)     â”‚
               â”‚                       â”‚
               â–¼                       â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚         INVENTORY                â”‚
        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
        â”‚ PK: id                           â”‚
        â”‚ UK: inventory_code               â”‚
        â”‚ FK: farmer_id                    â”‚
        â”‚ FK: storekeeper_id               â”‚
        â”‚ FK: warehouse_id                 â”‚
        â”‚ FK: crop_type_id                 â”‚
        â”‚     quantity_kg                  â”‚
        â”‚     remaining_quantity_kg        â”‚
        â”‚     quality_grade                â”‚
        â”‚     storage_date                 â”‚
        â”‚     expected_withdrawal_date     â”‚
        â”‚     status                       â”‚
        â”‚     notes                        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚ 1:M
                          â”‚
                          â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚        TRANSACTION               â”‚
        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
        â”‚ PK: id                           â”‚
        â”‚ UK: transaction_code             â”‚
        â”‚ FK: inventory_id                 â”‚
        â”‚ FK: buyer_id                     â”‚
        â”‚ FK: seller_id                    â”‚
        â”‚     quantity_kg                  â”‚
        â”‚     unit_price                   â”‚
        â”‚     total_amount                 â”‚
        â”‚     storage_fee                  â”‚
        â”‚     transaction_fee              â”‚
        â”‚     net_amount                   â”‚
        â”‚     payment_status               â”‚
        â”‚     delivery_status              â”‚
        â”‚     transaction_date             â”‚
        â”‚     payment_date                 â”‚
        â”‚     notes                        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚ 1:M
                          â”‚
                          â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚           RATING                 â”‚
        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
        â”‚ PK: id                           â”‚
        â”‚ FK: rater_id (user)              â”‚
        â”‚ FK: rated_user_id (user)         â”‚
        â”‚ FK: transaction_id               â”‚
        â”‚     rating_score (1-5)           â”‚
        â”‚     rating_type                  â”‚
        â”‚     comment                      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”— Relationship Matrix

| From Entity | To Entity | Relationship | Cardinality | Description |
|------------|-----------|--------------|-------------|-------------|
| **Location** | Location | Self-ref | 1:M | Parent-child hierarchy |
| **Location** | User | Has | 1:M | Users belong to locations |
| **Location** | StorageWarehouse | Contains | 1:M | Warehouses in locations |
| **User** | UserProfile | Has | 1:1 | Extended user info |
| **User** | WarehouseAccess | Has | 1:M | User's warehouse permissions |
| **User** | Inventory (farmer) | Creates | 1:M | Farmer brings crops |
| **User** | Inventory (storekeeper) | Logs | 1:M | Storekeeper records |
| **User** | Transaction (buyer) | Purchases | 1:M | Buyer transactions |
| **User** | Transaction (seller) | Sells | 1:M | Seller transactions |
| **User** | Rating (rater) | Gives | 1:M | Ratings given by user |
| **User** | Rating (rated) | Receives | 1:M | Ratings received |
| **StorageWarehouse** | WarehouseAccess | Accessed by | 1:M | Warehouse permissions |
| **StorageWarehouse** | Inventory | Stores | 1:M | Inventory in warehouse |
| **CropType** | Inventory | Categorizes | 1:M | Crop classification |
| **Inventory** | Transaction | Sold through | 1:M | Sales of inventory |
| **Transaction** | Rating | Rated for | 1:M | Transaction ratings |

---

## ğŸ“ Database Schema (Detailed)

### 1ï¸âƒ£ **LOCATION** (Hierarchical Administrative Structure)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              LOCATION                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id                 BIGINT        PK         â”‚
â”‚ code               VARCHAR(20)   UK, NN     â”‚
â”‚ name               VARCHAR(100)  NN         â”‚
â”‚ level              VARCHAR(20)   NN         â”‚
â”‚   â”œâ”€ PROVINCE                               â”‚
â”‚   â”œâ”€ DISTRICT                               â”‚
â”‚   â”œâ”€ SECTOR                                 â”‚
â”‚   â”œâ”€ CELL                                   â”‚
â”‚   â””â”€ VILLAGE                                â”‚
â”‚ parent_id          BIGINT        FK â†’ self  â”‚
â”‚ created_at         TIMESTAMP     NN         â”‚
â”‚ updated_at         TIMESTAMP                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Example Hierarchy:
  Kigali (Province)
    â””â”€ Gasabo (District)
        â””â”€ Kacyiru (Sector)
            â””â”€ Kamatamu (Cell)
                â””â”€ Kibaza (Village)
```

### 2ï¸âƒ£ **USER** (System Users)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 USER                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id                 BIGINT        PK         â”‚
â”‚ user_code          VARCHAR(20)   UK, NN     â”‚
â”‚ first_name         VARCHAR(50)   NN         â”‚
â”‚ last_name          VARCHAR(50)   NN         â”‚
â”‚ email              VARCHAR(100)  UK, NN     â”‚
â”‚ phone_number       VARCHAR(20)   UK, NN     â”‚
â”‚ password           VARCHAR(255)  NN         â”‚
â”‚ user_type          VARCHAR(20)   NN         â”‚
â”‚   â”œâ”€ FARMER                                 â”‚
â”‚   â”œâ”€ BUYER                                  â”‚
â”‚   â”œâ”€ STOREKEEPER                            â”‚
â”‚   â””â”€ ADMIN                                  â”‚
â”‚ status             VARCHAR(20)   NN         â”‚
â”‚   â”œâ”€ ACTIVE                                 â”‚
â”‚   â”œâ”€ SUSPENDED                              â”‚
â”‚   â””â”€ INACTIVE                               â”‚
â”‚ location_id        BIGINT        FK, NN     â”‚
â”‚ created_at         TIMESTAMP     NN         â”‚
â”‚ updated_at         TIMESTAMP                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3ï¸âƒ£ **USER_PROFILE** (Extended User Information)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            USER_PROFILE                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id                 BIGINT        PK         â”‚
â”‚ user_id            BIGINT        FK, UK, NN â”‚
â”‚ national_id        VARCHAR(16)   UK         â”‚
â”‚ date_of_birth      DATE                     â”‚
â”‚ gender             VARCHAR(10)              â”‚
â”‚   â”œâ”€ MALE                                   â”‚
â”‚   â”œâ”€ FEMALE                                 â”‚
â”‚   â””â”€ OTHER                                  â”‚
â”‚ profile_picture_url VARCHAR(255)            â”‚
â”‚ bio                TEXT                     â”‚
â”‚ verified           BOOLEAN       (false)    â”‚
â”‚ average_rating     NUMERIC(3,2)  (0.00)     â”‚
â”‚ created_at         TIMESTAMP     NN         â”‚
â”‚ updated_at         TIMESTAMP                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4ï¸âƒ£ **CROP_TYPE** (Agricultural Products)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              CROP_TYPE                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id                 BIGINT        PK         â”‚
â”‚ crop_code          VARCHAR(20)   UK, NN     â”‚
â”‚ crop_name          VARCHAR(100)  NN         â”‚
â”‚ category           VARCHAR(50)   NN         â”‚
â”‚   â”œâ”€ CEREALS                                â”‚
â”‚   â”œâ”€ LEGUMES                                â”‚
â”‚   â”œâ”€ TUBERS                                 â”‚
â”‚   â”œâ”€ VEGETABLES                             â”‚
â”‚   â”œâ”€ FRUITS                                 â”‚
â”‚   â””â”€ OTHER                                  â”‚
â”‚ measurement_unit   VARCHAR(20)   NN         â”‚
â”‚   â”œâ”€ KG                                     â”‚
â”‚   â”œâ”€ TONS                                   â”‚
â”‚   â””â”€ BAGS                                   â”‚
â”‚ description        TEXT                     â”‚
â”‚ created_at         TIMESTAMP     NN         â”‚
â”‚ updated_at         TIMESTAMP                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5ï¸âƒ£ **STORAGE_WAREHOUSE** (Physical Storage Facilities)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          STORAGE_WAREHOUSE                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id                 BIGINT        PK         â”‚
â”‚ warehouse_code     VARCHAR(20)   UK, NN     â”‚
â”‚ warehouse_name     VARCHAR(100)  NN         â”‚
â”‚ warehouse_type     VARCHAR(50)   NN         â”‚
â”‚   â”œâ”€ COOPERATIVE                            â”‚
â”‚   â”œâ”€ PRIVATE                                â”‚
â”‚   â””â”€ GOVERNMENT                             â”‚
â”‚ total_capacity_kg  NUMERIC(12,2) NN         â”‚
â”‚ available_capacity_kg NUMERIC(12,2) NN      â”‚
â”‚ status             VARCHAR(20)   NN         â”‚
â”‚   â”œâ”€ ACTIVE                                 â”‚
â”‚   â”œâ”€ MAINTENANCE                            â”‚
â”‚   â””â”€ CLOSED                                 â”‚
â”‚ location_id        BIGINT        FK, NN     â”‚
â”‚ created_at         TIMESTAMP     NN         â”‚
â”‚ updated_at         TIMESTAMP                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6ï¸âƒ£ **WAREHOUSE_ACCESS** (M:M Junction Table)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          WAREHOUSE_ACCESS                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id                 BIGINT        PK         â”‚
â”‚ user_id            BIGINT        FK, NN     â”‚
â”‚ warehouse_id       BIGINT        FK, NN     â”‚
â”‚ access_level       VARCHAR(20)   NN         â”‚
â”‚   â”œâ”€ OWNER                                  â”‚
â”‚   â”œâ”€ MANAGER                                â”‚
â”‚   â””â”€ VIEWER                                 â”‚
â”‚ granted_date       DATE          NN         â”‚
â”‚ expiry_date        DATE                     â”‚
â”‚ is_active          BOOLEAN       (true)     â”‚
â”‚ created_at         TIMESTAMP     NN         â”‚
â”‚ updated_at         TIMESTAMP                â”‚
â”‚ UNIQUE (user_id, warehouse_id)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7ï¸âƒ£ **INVENTORY** (Stored Crop Records)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              INVENTORY                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id                 BIGINT        PK         â”‚
â”‚ inventory_code     VARCHAR(20)   UK, NN     â”‚
â”‚ farmer_id          BIGINT        FK, NN     â”‚
â”‚ warehouse_id       BIGINT        FK, NN     â”‚
â”‚ crop_type_id       BIGINT        FK, NN     â”‚
â”‚ storekeeper_id     BIGINT        FK, NN     â”‚
â”‚ quantity_kg        NUMERIC(12,2) NN         â”‚
â”‚ remaining_quantity_kg NUMERIC(12,2) NN      â”‚
â”‚ quality_grade      VARCHAR(5)    NN         â”‚
â”‚   (A+, A, B, C, etc.)                       â”‚
â”‚ storage_date       DATE          NN         â”‚
â”‚ expected_withdrawal_date DATE               â”‚
â”‚ status             VARCHAR(20)   NN         â”‚
â”‚   â”œâ”€ STORED                                 â”‚
â”‚   â”œâ”€ PARTIALLY_SOLD                         â”‚
â”‚   â”œâ”€ SOLD                                   â”‚
â”‚   â””â”€ WITHDRAWN                              â”‚
â”‚ notes              TEXT                     â”‚
â”‚ created_at         TIMESTAMP     NN         â”‚
â”‚ updated_at         TIMESTAMP                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8ï¸âƒ£ **TRANSACTION** (Buy/Sell Transactions)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             TRANSACTION                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id                 BIGINT        PK         â”‚
â”‚ transaction_code   VARCHAR(20)   UK, NN     â”‚
â”‚ inventory_id       BIGINT        FK, NN     â”‚
â”‚ buyer_id           BIGINT        FK, NN     â”‚
â”‚ seller_id          BIGINT        FK, NN     â”‚
â”‚ quantity_kg        NUMERIC(12,2) NN         â”‚
â”‚ unit_price         NUMERIC(12,2) NN         â”‚
â”‚ total_amount       NUMERIC(12,2) NN         â”‚
â”‚ storage_fee        NUMERIC(12,2) (0.00)     â”‚
â”‚ transaction_fee    NUMERIC(12,2) (0.00)     â”‚
â”‚ net_amount         NUMERIC(12,2) NN         â”‚
â”‚ payment_status     VARCHAR(20)   NN         â”‚
â”‚   â”œâ”€ PENDING                                â”‚
â”‚   â”œâ”€ PAID                                   â”‚
â”‚   â””â”€ FAILED                                 â”‚
â”‚ delivery_status    VARCHAR(20)   NN         â”‚
â”‚   â”œâ”€ PENDING                                â”‚
â”‚   â”œâ”€ DELIVERED                              â”‚
â”‚   â””â”€ CANCELLED                              â”‚
â”‚ transaction_date   TIMESTAMP     NN         â”‚
â”‚ payment_date       TIMESTAMP                â”‚
â”‚ notes              TEXT                     â”‚
â”‚ created_at         TIMESTAMP     NN         â”‚
â”‚ updated_at         TIMESTAMP                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9ï¸âƒ£ **RATING** (User & Transaction Reviews)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               RATING                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id                 BIGINT        PK         â”‚
â”‚ rater_id           BIGINT        FK, NN     â”‚
â”‚ rated_user_id      BIGINT        FK, NN     â”‚
â”‚ transaction_id     BIGINT        FK, NN     â”‚
â”‚ rating_score       INTEGER       NN (1-5)   â”‚
â”‚ rating_type        VARCHAR(30)   NN         â”‚
â”‚   â”œâ”€ QUALITY                                â”‚
â”‚   â”œâ”€ RELIABILITY                            â”‚
â”‚   â”œâ”€ PAYMENT                                â”‚
â”‚   â””â”€ COMMUNICATION                          â”‚
â”‚ comment            TEXT                     â”‚
â”‚ created_at         TIMESTAMP     NN         â”‚
â”‚ updated_at         TIMESTAMP                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Data Flow Visualization

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SYSTEM WORKFLOW                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

PHASE 1: STORAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  Farmer
    â”‚
    â”œâ”€> Brings crops to warehouse
    â”‚
    â–¼
  Storekeeper
    â”‚
    â”œâ”€> Logs inventory in system
    â”‚   (Creates INVENTORY record)
    â”‚
    â–¼
  Warehouse
    â”‚
    â””â”€> Stores crops physically


PHASE 2: TRANSACTION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  Buyer
    â”‚
    â”œâ”€> Searches available inventory
    â”‚
    â”œâ”€> Initiates purchase
    â”‚   (Creates TRANSACTION record)
    â”‚
    â”œâ”€> Makes payment
    â”‚   (Updates payment_status)
    â”‚
    â–¼
  Seller (Farmer)
    â”‚
    â”œâ”€> Receives payment
    â”‚
    â””â”€> Inventory updated
        (remaining_quantity_kg decreases)


PHASE 3: RATING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  Buyer
    â”‚
    â”œâ”€> Rates Seller (quality, reliability)
    â”‚   (Creates RATING record)
    â”‚
    â–¼
  Seller
    â”‚
    â”œâ”€> Rates Buyer (payment, communication)
    â”‚   (Creates RATING record)
    â”‚
    â–¼
  System
    â”‚
    â””â”€> Updates average_rating in USER_PROFILE
```

---

## ğŸ“Š Statistics & Constraints

### **Primary Keys:** 9
- All tables use `BIGINT` auto-generated IDs

### **Foreign Keys:** 17
- Enforced referential integrity
- Cascade operations on delete/update

### **Unique Constraints:** 11
- Prevents duplicate business keys
- Examples: email, phone_number, user_code, etc.

### **Check Constraints:** 10
- Enforces business rules at database level
- Examples: rating_score (1-5), enum validations

### **NOT NULL Constraints:** 60+
- Ensures critical data integrity

---

## ğŸ¯ Key Features

### âœ… **Self-Referencing Hierarchy**
- Location table supports 5-level administrative structure
- Parent-child relationships enable cascading queries

### âœ… **Many-to-Many Relationship**
- Users â†” Warehouses via WarehouseAccess junction table
- Unique constraint prevents duplicate access grants

### âœ… **Multiple Role Support**
- User can be Farmer, Buyer, Storekeeper simultaneously
- Separate foreign keys in Inventory & Transaction tables

### âœ… **Soft Delete Support**
- `status` fields enable soft deletes
- `is_active` in WarehouseAccess for access revocation

### âœ… **Audit Trail**
- All tables have `created_at` and `updated_at` timestamps
- Automatic tracking via JPA annotations

### âœ… **Business Logic Enforcement**
- Enum constraints for controlled values
- Check constraints for valid ranges
- Unique constraints for business rules

---

## ğŸ” Indexes (Recommended)

```sql
-- High-priority indexes for performance
CREATE INDEX idx_user_email ON user(email);
CREATE INDEX idx_user_phone ON user(phone_number);
CREATE INDEX idx_user_location ON user(location_id);
CREATE INDEX idx_warehouse_location ON storage_warehouse(location_id);
CREATE INDEX idx_inventory_farmer ON inventory(farmer_id);
CREATE INDEX idx_inventory_warehouse ON inventory(warehouse_id);
CREATE INDEX idx_transaction_buyer ON transaction(buyer_id);
CREATE INDEX idx_transaction_seller ON transaction(seller_id);
CREATE INDEX idx_rating_rated_user ON rating(rated_user_id);
```

---

## ğŸ“ˆ Scalability Considerations

| Aspect | Current | Scalable To |
|--------|---------|-------------|
| **Users** | Thousands | Millions |
| **Locations** | Hundreds | Fixed (Rwanda admin units) |
| **Warehouses** | Hundreds | Thousands |
| **Inventory** | Thousands | Millions |
| **Transactions** | Thousands | Millions |
| **Ratings** | Thousands | Millions |

---

**Generated:** October 29, 2025  
**Database:** PostgreSQL 18.0  
**Framework:** Spring Boot 3.5.7 + Hibernate 6.6.33

